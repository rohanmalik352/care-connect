<%- include('../partials/head') %>
<%- include('../partials/navbar') %>
<div class="container py-4">
  <%- include('../partials/flash') %>
  <h2 class="fw-bold mb-4"><i class="fas fa-cog me-2 text-teal"></i>Admin Dashboard</h2>

  <div class="row g-3 mb-4">
    <div class="col-6 col-md-3">
      <div class="stat-card card border-0 shadow-sm text-center p-4">
        <div class="stat-icon teal mb-2"><i class="fas fa-users"></i></div>
        <div class="fw-bold fs-3"><%= totalUsers %></div>
        <div class="text-muted">Total Users</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="stat-card card border-0 shadow-sm text-center p-4">
        <div class="stat-icon blue mb-2"><i class="fas fa-user-md"></i></div>
        <div class="fw-bold fs-3"><%= totalDoctors %></div>
        <div class="text-muted">Doctors</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="stat-card card border-0 shadow-sm text-center p-4">
        <div class="stat-icon green mb-2"><i class="fas fa-user-injured"></i></div>
        <div class="fw-bold fs-3"><%= totalPatients %></div>
        <div class="text-muted">Patients</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="stat-card card border-0 shadow-sm text-center p-4">
        <div class="stat-icon red mb-2"><i class="fas fa-file-medical"></i></div>
        <div class="fw-bold fs-3"><%= totalRecords %></div>
        <div class="text-muted">Records</div>
      </div>
    </div>
  </div>

  <div class="card border-0 shadow-sm">
    <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center">
      <h5 class="fw-bold mb-0"><i class="fas fa-clock me-2 text-warning"></i>Pending Doctor Verifications (<%= unverifiedDoctors.length %>)</h5>
      <a href="/admin/doctors" class="btn btn-sm btn-outline-teal">View All Doctors</a>
    </div>
    <div class="card-body p-0">
      <% if (unverifiedDoctors.length === 0) { %>
        <div class="text-center py-5 text-muted">
          <i class="fas fa-check-circle fa-3x mb-3 text-success opacity-50"></i>
          <p>All doctors verified!</p>
        </div>
      <% } else { %>
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light"><tr><th>Name</th><th>Email</th><th>Registration No.</th><th>Specialization</th><th>Action</th></tr></thead>
            <tbody>
              <% unverifiedDoctors.forEach(d => { %>
                <tr>
                  <td>Dr. <%= d.user?.name %></td>
                  <td><%= d.user?.email %></td>
                  <td><%= d.registrationNumber || '<span class="text-muted">Not provided</span>' %></td>
                  <td><%= d.specialization || 'â€”' %></td>
                  <td>
                    <form action="/admin/doctors/<%= d._id %>/verify" method="POST" style="display:inline">
                      <button type="submit" class="btn btn-success btn-sm"><i class="fas fa-check me-1"></i>Verify</button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      <% } %>
    </div>
  </div>
</div>
<%- include('../partials/footer') %>
